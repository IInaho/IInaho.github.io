
+++
authors = ["lzy"]
title = "Linux 磁盘清理"
date = "2025-09-10 16:20:20"
description = ""
tags = [
"linux"
]
categories = [
"技术文档"
]
+++

## 一、Linux 系统垃圾文件的判定

长期以来存在 “Linux 没有垃圾文件，Windows 才有垃圾文件” 的误区，实际二者均会产生垃圾文件：

- 操作系统本质是 “操作文件的系统”，运行过程中必然产生日志文件、临时文件（类似 “剪纸产生废料”）
- Linux 中的 “垃圾文件” 可定义为 “长期无实用价值的文件”，例如：

  - 几年前 / 几个月前的旧日志文件（对当前系统运维无参考意义）
  - 体积过大且无保留必要的日志文件（如 /var/log/journal/ 下占用数 GB 的历史日志）

## 二、日志文件的查看方法

当发现 Linux 系统根分区空间告急时，可通过以下命令定位 /var/log/journal/ 日志文件的占用情况：

- 方法：使用 `journalctl` 直接查看 journal 日志的磁盘占用：

```bash
journalctl --disk-usage
```

示例结果：/var/log/journal 日志文件可能占用近 3G 空间，单个文件体积 8-128M。

## 三、日志文件的清理方法

使用 journalctl 自动维护日志大小，通过 `journalctl` 命令配置日志保留规则，实现自动清理，支持按 “时间” 或 “大小” 限制：

- 按时间限制：仅保留近 1 周的日志（可将 `1w` 替换为 `1d`（1 天）、`1m`（1 个月）等）：

```bash
journalctl --vacuum-time=1w
```

- 按大小限制：仅保留 500MB 的日志（可将 `500M` 替换为 `1G`、`100M` 等）：

```bash
journalctl --vacuum-size=500M
```

- 直接删除指定日志目录（彻底清理，需谨慎）：

```bash
rm -rf /var/log/journal/f9d400c5e1e8c3a8209e990d887d4ac1  # 替换为实际日志目录名
```

清理效果示例：执行 `journalctl --vacuum-size=10M` 后，可腾出约 2.7G 空间，通过 `df` 命令可查看根分区空间明显释放
